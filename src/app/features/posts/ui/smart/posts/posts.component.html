@if (postsLoadingStatus === 'loading') {
    <div class="wrapper">
        <mat-spinner color="primary" [diameter]="40"></mat-spinner>
    </div>
}

@if (postsLoadingStatus === 'failed' || this.posts.length === 0) {
    <div>Posts didn't load</div>
} @else {
    <app-post-form [formData]="formGroup" (onSubmit)="createPost()"></app-post-form>

    <div class="posts-actions">
        <mat-form-field>
            <mat-label>Filters:</mat-label>
            <mat-select>
                @for (filter of filters; track filter) {
                    <mat-option [value]="filter.label" (click)="applyFilters(filter.label)">{{ filter.label }}</mat-option>
                }
            </mat-select>
        </mat-form-field>

        @if (activeFilter !== null) {
            <button mat-flat-button (click)="resetFilters()">Reset</button>
        }

        <mat-form-field class="search" appearance="outline">
            <mat-label>Search</mat-label>
            <input matInput type="text" [(ngModel)]="searchQuery" (ngModelChange)="searchPosts()">
        </mat-form-field>
    </div>

    @if (searchQuery && filteredPosts.length === 0) {
        <div>Posts not found</div>
    } @else {
        <section>
            @for (post of filteredPosts; track post.id) {
                <app-post-card
                    [post]="post"
                    (postDeleted)="deletePost($event)"
                    (postEdited)="updatePost($event)"
                ></app-post-card>
            }
        </section>
    }
}
